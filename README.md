# Project for T1 consulting

## EDT схема
![Cхема](https://github.com/SergeiBrin/project-for-t1/blob/main/lines%20EDT.png)

## Описание проекта
Приложение Project for T1 consulting - это сервис, который вычисляет частоту встречи символов по заданной строке. 
Результат сортируется по убыванию количества вхождений символа в заданную строку.  

## Работа с API
Для того, чтобы воспользоваться сервисом, необходимо сформировать запрос по следующему адресу:  

`
http://localhost:8080/lines?line={ваша строка}
`,  
где {ваша строка} - это строка, для которой нужно выполнить вычисления. Строка должна быть закодирована в формате URL. Кроме того, её длина не должна превышать 10 000 символов. 

При корректном запросе сервис вернет ответ в виде JSON-объекта, содержащего пары: 
"{символ}" : {количество}

Например, для строки "hello world" ответ будет таким:  
`
"l" : 3, "o" : 2, "h" : 1, "e" : 1, "w" : 1, "r" : 1, "d" : 1
`  

Запрос можно отправить через любой браузер или через специальный инструмент для тестирования API, такой, как Postman. 
Во втором случае для HTTP запроса нужно выбрать метод GET.

## Технические особенности
Приложение использует базу данных Postgres для хранения и обработки готовых решений, что повышает скорость ответа сервера. 
Эта функция позволяет приложению адаптироваться к входящим данным и обучаться на них.

Алгоритм работает следующим образом:
1. Клиент формирует запрос и отправляет его на сервер;
2. Сервер проверяет, есть ли такой запрос в своей базе данных. Если есть, то сервер извлекает соответствующий ответ 
и возвращает его клиенту;
3. Если такого запроса нет в базе данных, то сервер выполняет необходимые вычисления и сортировку для данного запроса 
и сохраняет результат в базе данных. Таким образом, при повторном запросе этой же строки, вычисления не потребуются.

## Описание таблицы
1. **lines** - хранит входящие строки.
2. **sequences** - хранит результаты вычислений этих строк.

## Стек технологий
1. Java 17;
2. Maven;
3. Spring Boot 3.1.3
4. Spring Mvc;
5. Spring Data;
6. Hibernate;
7. Postgres;
8. H2 (для тестов);
9. Docker;
10. Junit 5, Mockito, MockMvc.

## Инструкция по развёртыванию
В pgAdmin4 создайте базу данных **lines**.  

Чтобы запустить приложение в IntelijIdea, зайдите в «Edit Congigurations -> Add new configuration, 
создайте две конфигурации и добавьте в каждую из них переменные окружения – Environment variables: 
1. Application – для работы приложения:
```
POSTGRES_USER={ваш логин};
POSTGRES_PASSWORD={ваш пароль};    
SPRING_DATASOURCE_URL=jdbc:postgresql://localhost:5432/lines
```
2. Junit – для тестов:
```
spring.profiles.active=test
```

Чтобы запустить приложение в Docker выполните следующие шаги:
1. Соберите jar c помощью команды mvn clean package - для всего проекта;
2. Запустите Docker;
3. Откройте командную строку;
4. Перейдите в корневую папку проекта;
5. Введите команду docker-compose up.





